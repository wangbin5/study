### 可扩展架构
- 可扩展架构基本思想： 拆
    - 面向流程（数据移动流程）拆分：分层架构
    - 面向服务拆分：SOA、微服务架构
    - 面向功能拆分：微内核架构
     
#### 1. 分层架构
    - 保证各层之间差异足够清晰，边界足够明显
    - 保证层与层之间的依赖是稳定的
    - 业务流程依层依次传递，不能再层之间跳跃
    - 本质：隔离关注点
    - 缺点：有些罗嗦和冗余，但是复杂度不高
    
#### 2. SOA
    - 服务
    - ESB：需要实现与各种系统间的协议转换、数据转换、透明的动态路由等，会成为性能瓶颈
    - 松耦合：服务独立运行，通过ESB交换数据
    
#### 3. 微服务架构
- 接口级故障处理
    - 原则：优先保证核心业务和优先保证绝大部分用户 
    - 降级
        - 核心思想是丢车保帅，优先保证核心业务
        - 应对系统自身的故障
    - 熔断
        - 应对依赖外部系统的故障
        - API调用层收集数据，执行逻辑
    - 限流
        - 从用户访问压力角度应对故障
        - 基于请求限流：限制总量、限制时间范围内某个指标的量
        - 基于资源限流：
            - 限制系统内关键资源使用上限，如： 数据库连接数、线程数
    - 排队： 限流的变种，用户体验不一定比限流好
    
#### 4. 微内核架构（插件化架构）
- 核心组件：
    - 核心系统（core system）
    - 插件模块（plug-in modules） 
- 关键技术
    - 插件管理：插件注册表，包括插件的名字、位置、加载时机
    - 插件连接：核心系统必须制定插件和核心系统的连接规范，插件按规范设计           
    - 插件通信：核心系统提供通信机制，供插件间交换数据
- 实例：
    - OSGI: Equinox/Spring DM
    - 规则引擎:
        - 开发人员将业务功能分解提炼为多个规则，将规则保存在规则库中。
        - 业务人员根据业务需要，通过将规则排列组合，配置成业务流程，保存在业务库中
        - 规则引擎执行业务流程实现业务功能
        - 规则 -- 插件 ， 规则引擎 -- 核心系统 ， 规则库/业务库 -- 注册中心  