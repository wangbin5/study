#### 单体架构的问题
- 部署效率低下
= 团队协作开发成本高
- 系统高可用性差
- 线上发布变慢

#### 与单体架构相比，微服务的优点
- 服务化就是把传统的单机应用中通过 JAR 包依赖产生的本地方法调用，改造成通过 RPC 接口产生的远程方法调用
- 微服务相比于服务化的特点
    - 服务拆分粒度更细
    - 服务独立部署
    - 服务独立维护
    - 服务治理能力要求高
- 优势: 小系统、小团队、部署容易、交付效率高
    - 微服务架构是将复杂臃肿的单体应用进行细粒度的服务化拆分
    - 每个拆分出来的服务各自独立打包部署
    - 交由小团队进行开发和运维
    - 极大地提高了应用交付的效率 

#### 单体服务的拆分方式
- 拆分时机: 人员规模超过10人
- 拆分方式
    - 纵向拆分 从业务维度进行拆分
    - 横向拆分 从公共且独立功能维度拆分
- 微服务机构的前置条件
    - 服务如何定义 
    - 服务如何发布和订阅 注册中心
    - 服务间如何通信       
    - 服务如何监控        
    - 服务如何治理        
    - 故障如何定位

#### 微服务机构的组成
- https://static001.geekbang.org/resource/image/41/3b/419b77a39e6b7e4fcaa5456aa9d9253b.png
- 服务描述
    - 接口描述，Swagger
- 注册中心
- 服务框架
    - 通信协议
    - 传输方式
    - 序列号方式
- 服务监控
    - 通用的监控方案，覆盖业务埋点、数据收集、数据处理，最后到数据展示的全链路功能
- 服务追踪
    - 作用
        - 优化系统瓶颈。
        - 优化链路调用
        - 生成网络拓扑
        - 透明传输数据   
    - 核心理念就是调用链 
- 服务治理
    - 服务治理就是通过一系列的手段来保证在各种意外情况下，服务调用仍然能够正常进行 
    - 负载均衡
    - 服务路由
        - 业务存在灰度发布的需求
        - 多机房就近访问的需求
    - 服务容错      
        - 故障分类及处理方式
            - 集群故障: 限流和降级
            - 单 IDC 故障: 基于 DNS 解析的流量切换 & 基于 RPC 分组的流量切换
            - 单机故障: 把有问题的机器从线上集群中摘除掉 & 自动重启
        - 服务调用失败处理方式
            - 设置超时时间
            - 重试
            - 双发: 给定的时间内如果没有返回请求结果，再发送第二次请求
            - 熔断

            

    
